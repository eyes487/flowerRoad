var formGroup=document.getElementsByTagName("form")[0],userName=formGroup.getElementsByTagName("input")[0],code=document.getElementById("code"),email=formGroup.getElementsByTagName("input")[2],passWord=formGroup.getElementsByTagName("input")[3],pWCopy=formGroup.getElementsByTagName("input")[4],checkBox=document.getElementsByClassName("port")[0],hint=formGroup.getElementsByClassName("hint"),lrBtn=document.getElementsByClassName("lrBtn")[0],captcha="";function checkName(){var e=userName.value.trim();ajax({type:"post",url:"enroll",data:"nameT="+e,dataType:"text",success:function(e){hint[0].innerText=e}})}function checkEmail(){var e=email.value.trim();ajax({type:"post",url:"mailbox",data:"emailT="+e,dataType:"JSON",success:function(e){console.log(e)}});var t=/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/;""!=e&&(console.log(t.test(e)),t.test(e)?hint[2].innerText="":hint[2].innerText="请填写有效的邮箱")}function checkPW(){var e=passWord.value.trim();""!=e&&(e.length<6||12<e.length?hint[3].innerText="请填写6-12位字符":hint[3].innerText="")}function copyPW(){var e=passWord.value.trim(),t=pWCopy.value.trim();""!=t&&(hint[4].innerText=t!=e?"两次密码不一致":"")}function checkEvery(){""!=userName.value&&""!=email.value&&""!=passWord.value&&""!=pWCopy.value&&0!=checkBox.checked||(lrBtn.setAttribute("disabled",!0),lrBtn.style.background="#6f6969"),""!=userName.value&&""!=email.value&&""!=passWord.value&&""!=pWCopy.value&&1==checkBox.checked&&"可以注册"==hint[0].innerText&&""==hint[1].innerText&&""==hint[2].innerText&&""==hint[3].innerText&&""==hint[4].innerText&&(lrBtn.removeAttribute("disabled"),lrBtn.style.background="#ef4b28",clearInterval(subtime))}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};var subtime=setInterval(checkEvery,500);function register(){var e=document.getElementsByClassName("code")[0].value,t=document.getElementsByClassName("userName")[0].value,a=$.md5(passWord.value);e.toUpperCase()===captcha.toUpperCase()?ajax({type:"post",url:"register",data:"userName="+t+"&email="+email.value+"&pwd="+a,dataType:"text",success:function(e){1==e?(layer.msg("注册成功,2s后自动跳转登录页",{icon:1}),setTimeout(function(){location.href="login.html"},2e3)):layer.msg("注册失败",{icon:2})}}):layer.msg("验证码输入不正确",{icon:2})}function createCode(){var a=document.getElementById("code");ajax({type:"get",url:"captcha",data:"",success:function(e){var t=JSON.parse(e);captcha=t.text,a.innerHTML=t.code,console.log(t)}})}createCode();